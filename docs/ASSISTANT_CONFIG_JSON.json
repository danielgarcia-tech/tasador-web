{
  "assistant_configuration": {
    "metadata": {
      "name": "Asesor Baremos",
      "id": "asst_ZRKOTi9BkuvF5vTyNgczTOu2",
      "description": "Especialista en cálculo de honorarios según baremos ICA",
      "model": "gpt-4-turbo",
      "created_date": "2025-10-22"
    },
    "system_prompt": "ERES UN ESPECIALISTA EN BAREMOS DE HONORARIOS DE ABOGADOS\n\nTu misión es proporcionar respuestas PRECISAS, NUMÉRICAS y FUNDAMENTADAS sobre criterios de honorarios.\n\n## REGLAS FUNDAMENTALES\n\n1. **SIEMPRE cita el criterio exacto**\n   - Ejemplo correcto: \"Según Criterio 3.1...\"\n   - Ejemplo incorrecto: \"probablemente depende...\"\n\n2. **PROPORCIONA CÁLCULOS DESGLOSADOS**\n   - Base: €X\n   - Incremento/Reducción: €Y\n   - Total: €Z\n   - Nunca solo un número sin explicación\n\n3. **INCLUYE INCREMENTOS Y REDUCCIONES**\n   - Criterio 5.X: Incrementos por complejidad (+5% a +25%)\n   - Criterio 7.X: Reducciones por alegaciones (-10%), desistimiento (-15%), conformidad (-20%)\n   - Las reducciones NO se acumulan, aplica la MAYOR\n\n4. **USA ESTE FORMATO EXACTO**\n\n   RESPUESTA DIRECTA:\n   El honorario es de €XXXX según Criterio X.X\n   \n   CÁLCULO DETALLADO:\n   1. Cuantía: €X\n   2. Criterio base (X.X): €Y × Z% = €RESULTADO\n   3. Incremento/Reducción: [si aplica]\n   4. TOTAL: €FINAL\n   \n   FUNDAMENTACIÓN:\n   [Explicación del criterio]\n   \n   CONDICIONES:\n   [Cuándo aplica]\n   \n   FUENTE: [Criterio, página]\n\n5. **MANTÉN PRECISIÓN NUMÉRICA**\n   - Verifica cálculos matemáticos\n   - No redondees arbitrariamente\n   - Muestra decimales si es necesario\n\n6. **CUANDO NO TENGAS INFORMACIÓN**\n   - Responde: \"No encontrado en el baremo disponible\"\n   - Sugiere qué información necesitas\n   - No inventes criterios\n\n## EJEMPLOS DE RESPUESTAS CORRECTAS\n\n### Ejemplo 1: Pregunta Básica\nQ: \"¿Cuál es el honorario para un caso de €50.000?\"\nA: \n```\nRESPUESTA: €2.000\n\nCÁLCULO:\n- Cuantía: €50.000\n- Criterio 3.1 (Rango €30K-€60K): 4%\n- Honorario: €50.000 × 4% = €2.000\n\nFUENTE: Criterio 3.1\n```\n\n### Ejemplo 2: Con Incremento\nQ: \"¿Si es complejidad media?\"\nA:\n```\nRESPUESTA: €2.300\n\nCÁLCULO:\n- Base anterior: €2.000\n- Criterio 5.2 (Complejidad media): +15%\n- Incremento: €2.000 × 15% = €300\n- TOTAL: €2.000 + €300 = €2.300\n\nCONDICIONES:\n- Complejidad media: múltiples cuestiones jurídicas\n- Jurisprudencia compleja\n\nFUENTE: Criterio 5.2\n```\n\n### Ejemplo 3: Con Reducción\nQ: \"¿Reducción por alegaciones?\"\nA:\n```\nRESPUESTA: €2.070\n\nCÁLCULO:\n- Base anterior: €2.300\n- Criterio 7.1 (Alegaciones): -10%\n- Reducción: €2.300 × 10% = €230\n- TOTAL: €2.300 - €230 = €2.070\n\nNOTA: La reducción se aplica sobre el total incluyendo incrementos.\n\nFUENTE: Criterio 7.1\n```\n\n## ESTRUCTURA DE CRITERIOS TÍPICOS\n\nEstos son los tipos de criterios que encontrarás:\n\n**Criterios 1.X - Cuantía**\n- Rango: €0-€6.000 → Porcentaje: X%\n- Rango: €6.000-€30.000 → Porcentaje: Y%\n- Rango: €30.000-€60.000 → Porcentaje: Z%\n\n**Criterios 3.X - Base de cálculo**\n- Concepto procesal específico\n- Porcentaje aplicable\n- Condiciones especiales\n\n**Criterios 5.X - Incrementos**\n- Por complejidad: +5% a +25%\n- Por diligencia: +10% a +30%\n- Por responsabilidad: +15% a +50%\n\n**Criterios 7.X - Reducciones**\n- Por alegaciones: -10%\n- Por conformidad: -15%\n- Por desistimiento: -20%\n\n## VALIDACIÓN DE DATOS\n\nAntes de responder, VERIFICA:\n- ¿Tengo el documento del baremo correcto? (CCAA y año)\n- ¿Conozco el criterio exacto? (3.1, 5.2, etc.)\n- ¿Puedo desglosar numéricamente? (Si no, pido más datos)\n- ¿La respuesta se fundamenta en el documento? (Si no, digo \"no encontrado\")\n\n## SEÑALES DE ALERTA\n\nSi el usuario pregunta sobre:\n- **Caso sin datos suficientes**: \"Necesito: cuantía exacta, tipo de procedimiento, complejidad estimada\"\n- **Criterio no en documento**: \"Este criterio no aparece en el baremo de [CCAA]\"\n- **Excepción no documentada**: \"El documento no especifica esta situación\"\n\n## TONO Y CLARIDAD\n\n- Directo y técnico\n- Números en negrita: **€2.500**\n- Criterios en formato: **Criterio 3.1**\n- Reducciones/Incrementos claros: **+15%** o **-10%**\n- Siempre cita: **[Fuente: pág. XX]**",
    "response_format": {
      "type": "json_schema",
      "json_schema": {
        "name": "calculo_honorarios",
        "description": "Respuesta estructurada para cálculos de honorarios según baremos",
        "schema": {
          "type": "object",
          "properties": {
            "resumen": {
              "type": "object",
              "description": "Resumen ejecutivo de la respuesta",
              "properties": {
                "honorario_total": {
                  "type": "number",
                  "description": "Honorario final calculado en EUR",
                  "minimum": 0
                },
                "moneda": {
                  "type": "string",
                  "enum": ["EUR"],
                  "description": "Moneda del cálculo"
                },
                "estado": {
                  "type": "string",
                  "enum": ["calculado", "estimacion", "no_encontrado", "error"],
                  "description": "Estado del cálculo"
                }
              },
              "required": ["honorario_total", "moneda", "estado"]
            },
            "cuantia_proceso": {
              "type": "object",
              "description": "Detalles de la cuantía del proceso",
              "properties": {
                "valor": {
                  "type": "number",
                  "description": "Valor monetario del proceso en EUR",
                  "minimum": 0
                },
                "tipo": {
                  "type": "string",
                  "enum": ["determinada", "indeterminada"],
                  "description": "Si la cuantía es determinada o indeterminada"
                },
                "rango_aplicable": {
                  "type": "string",
                  "description": "Rango de cuantía donde cae (ej: €30.000-€60.000)"
                }
              },
              "required": ["valor", "tipo"]
            },
            "criterio_base": {
              "type": "object",
              "description": "Criterio base aplicado para el cálculo",
              "properties": {
                "codigo": {
                  "type": "string",
                  "description": "Código del criterio (ej: 3.1)"
                },
                "nombre": {
                  "type": "string",
                  "description": "Nombre descriptivo del criterio"
                },
                "porcentaje": {
                  "type": "number",
                  "description": "Porcentaje aplicado",
                  "minimum": 0,
                  "maximum": 100
                },
                "valor_calculado": {
                  "type": "number",
                  "description": "Valor resultante en EUR",
                  "minimum": 0
                },
                "fundamentacion": {
                  "type": "string",
                  "description": "Explicación de por qué aplica este criterio"
                }
              },
              "required": ["codigo", "nombre", "porcentaje", "valor_calculado"]
            },
            "incrementos": {
              "type": "array",
              "description": "Incrementos aplicados al honorario base",
              "items": {
                "type": "object",
                "properties": {
                  "criterio": {
                    "type": "string",
                    "description": "Código del criterio de incremento (ej: 5.2)"
                  },
                  "tipo": {
                    "type": "string",
                    "enum": ["complejidad", "diligencia", "responsabilidad", "otro"],
                    "description": "Tipo de incremento"
                  },
                  "nivel": {
                    "type": "string",
                    "enum": ["baja", "media", "alta"],
                    "description": "Nivel del incremento"
                  },
                  "porcentaje": {
                    "type": "number",
                    "description": "Porcentaje de incremento",
                    "minimum": 0
                  },
                  "valor_calculado": {
                    "type": "number",
                    "description": "Valor del incremento en EUR"
                  },
                  "aplicado": {
                    "type": "boolean",
                    "description": "Si el incremento fue aplicado"
                  },
                  "motivo": {
                    "type": "string",
                    "description": "Explicación de por qué se aplicó"
                  }
                },
                "required": ["criterio", "tipo", "porcentaje", "valor_calculado", "aplicado"]
              }
            },
            "reducciones": {
              "type": "array",
              "description": "Reducciones aplicadas al honorario",
              "items": {
                "type": "object",
                "properties": {
                  "criterio": {
                    "type": "string",
                    "description": "Código del criterio de reducción (ej: 7.1)"
                  },
                  "tipo": {
                    "type": "string",
                    "enum": ["alegaciones", "desistimiento", "conformidad", "otro"],
                    "description": "Tipo de reducción"
                  },
                  "porcentaje": {
                    "type": "number",
                    "description": "Porcentaje de reducción",
                    "minimum": 0,
                    "maximum": 100
                  },
                  "valor_calculado": {
                    "type": "number",
                    "description": "Valor de la reducción en EUR (negativo)"
                  },
                  "aplicado": {
                    "type": "boolean",
                    "description": "Si la reducción fue aplicada"
                  },
                  "motivo": {
                    "type": "string",
                    "description": "Razón de la reducción"
                  }
                },
                "required": ["criterio", "tipo", "porcentaje", "valor_calculado", "aplicado"]
              }
            },
            "desglose_calculos": {
              "type": "array",
              "description": "Paso a paso del cálculo",
              "items": {
                "type": "object",
                "properties": {
                  "paso": {
                    "type": "integer",
                    "description": "Número de paso",
                    "minimum": 1
                  },
                  "descripcion": {
                    "type": "string",
                    "description": "Descripción de la operación"
                  },
                  "operacion": {
                    "type": "string",
                    "description": "Fórmula matemática (ej: 50000 × 4%)"
                  },
                  "resultado": {
                    "type": "number",
                    "description": "Resultado de esta operación"
                  },
                  "subtotal": {
                    "type": "number",
                    "description": "Subtotal acumulado hasta este paso"
                  }
                },
                "required": ["paso", "descripcion", "operacion", "resultado"]
              }
            },
            "criterios_aplicables": {
              "type": "array",
              "description": "Lista de todos los criterios relevantes encontrados",
              "items": {
                "type": "object",
                "properties": {
                  "codigo": {
                    "type": "string",
                    "description": "Código del criterio"
                  },
                  "nombre": {
                    "type": "string",
                    "description": "Nombre del criterio"
                  },
                  "descripcion": {
                    "type": "string",
                    "description": "Descripción completa"
                  },
                  "aplicado": {
                    "type": "boolean",
                    "description": "Si fue aplicado en este cálculo"
                  },
                  "razon_no_aplicado": {
                    "type": "string",
                    "description": "Si no se aplicó, la razón"
                  }
                },
                "required": ["codigo", "nombre", "aplicado"]
              }
            },
            "condiciones_especiales": {
              "type": "object",
              "description": "Condiciones especiales del baremo",
              "properties": {
                "acumulacion_criterios": {
                  "type": "string",
                  "description": "Explicación sobre si se acumulan criterios"
                },
                "limitaciones": {
                  "type": "array",
                  "description": "Limitaciones aplicables",
                  "items": {
                    "type": "string"
                  }
                },
                "excepciones": {
                  "type": "array",
                  "description": "Excepciones encontradas",
                  "items": {
                    "type": "string"
                  }
                }
              }
            },
            "fuente": {
              "type": "object",
              "description": "Información de la fuente del baremo",
              "properties": {
                "baremo": {
                  "type": "string",
                  "description": "Nombre del baremo (ej: ICA Madrid)"
                },
                "ccaa": {
                  "type": "string",
                  "description": "Comunidad autónoma"
                },
                "ano": {
                  "type": "integer",
                  "description": "Año del baremo",
                  "minimum": 2000
                },
                "paginas": {
                  "type": "string",
                  "description": "Páginas consultadas (ej: 8-12)"
                },
                "referencia_completa": {
                  "type": "string",
                  "description": "Referencia completa del documento"
                }
              },
              "required": ["baremo", "ccaa"]
            },
            "observaciones": {
              "type": "array",
              "description": "Observaciones importantes sobre el cálculo",
              "items": {
                "type": "string"
              }
            },
            "proximos_pasos": {
              "type": "array",
              "description": "Sugerencias o próximos pasos si aplica",
              "items": {
                "type": "string"
              }
            }
          },
          "required": [
            "resumen",
            "cuantia_proceso",
            "criterio_base",
            "fuente"
          ],
          "additionalProperties": false
        },
        "strict": true
      }
    },
    "tools": {
      "file_search": true,
      "code_interpreter": false,
      "web_browser": false
    },
    "vector_store": {
      "id": "vs_68f8db9ce9808191ad733dd979c6af14",
      "status": "connected",
      "description": "PDFs de baremos por CCAA"
    },
    "instructions_for_openai_dashboard": {
      "paso_1": "Ve a https://platform.openai.com/assistants",
      "paso_2": "Selecciona o crea el Assistant: asst_ZRKOTi9BkuvF5vTyNgczTOu2",
      "paso_3": "En la sección 'Instructions', copia y pega todo el contenido de 'system_prompt'",
      "paso_4": "En la sección 'Response format', selecciona 'JSON schema'",
      "paso_5": "Copia y pega todo el contenido de 'response_format.json_schema'",
      "paso_6": "En 'Tools', habilita 'File search' y deshabilita 'Code interpreter' y 'Web browser'",
      "paso_7": "Verifica que el Vector Store esté conectado: vs_68f8db9ce9808191ad733dd979c6af14",
      "paso_8": "Guarda los cambios"
    }
  }
}
